# Рекомендательная модель онлайн-супермаркета Копейка (на базе датасета Dunhunby).
Сервис реализован на фронте Telegram и позволяет получить рекомендации товаров для текущих пользователей. Рекомендаций для новых пользователей не предусмотрено прототипом.

---

## Описание проекта

Рекомендации формируются на базе клиентских характеристик и модели ранжирования XGBRanker. 
В целях оптимизации скорости выполнения задания, было принято решения не использовать модель внутри сервиса, а как источник брать уже сформированные рекомендации в .csv.
Т.к. прототип не предполагает новых пользователей, а обучение модели строилось на N-ом кол-ве фичей, это решение оказалось более чем приемлемо. Быстро и дешево.

Кроме рекомендаций, сервис предоставляет пользователю бота описание характеристик клиента магазина.

Концептуально, в продакшене, модель должна встраиваться UI корзины онлайн-магазина и рекомендовать товары, которые клиент в корзину не положил (т.е. из списка релевантных рекомендаций убирать то, что он уже положил в корзину).

---

## Функционал

### FastAPI
- `/api/v1/recommendations/{user_id}` — получить рекомендации конкретного пользователя
- `/api/v1/requests/{telegram_login}` — история запросов пользователя
- `/api/v1/requests` — эндпоинт для получения истории (через RabbitMQ)

### Telegram-бот
- `/start` — главное меню
- «Ввести ID» — получить рекомендации по ID
- «Случайный пользователь» — получить случайного пользователя
- «Мои запросы» — показывает последние 5 запросов

---

## Структура проекта
mfdp/  
├── app/  
│ ├── main.py  
│ ├── api.py  
│ ├── database.py  
│ ├── models.py  
│ └── items.py  
│ └── debug_api.py  
│ └── field_mapping.py  
│ └── requests_api.py  
│ └── utils.py  
├── bot/  
│ └── bot.py   
├── data/  
│ ├── recommendations_results.csv   
│ └── dict_items.xls  
├── import_csv.py  
├── worker  
  └── model_worker.py  
├── Dockerfile  
├── docker-compose.yml  
└── .env  
└── setup.py  
└── requirements.txt  

---

## Как запустить

1. Установить:
   - Docker
   - Docker Compose
   - Python 3.8+

2. Создать `.env` файл:

```bash
DB_HOST=postgres
DB_PORT=5432
DB_NAME=mfdp
DB_USER=admin
DB_PASSWORD=admin
TELEGRAM_BOT_TOKEN=your_bot_token_here
RABBITMQ_URL=amqp://guest:guest@rabbitmq/

3. Запустить проект
    - docker-compose up --build
